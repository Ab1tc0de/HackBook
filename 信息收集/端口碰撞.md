# 什么是端口碰撞
* 端口敲门是一种通过在一组预先指定的关闭端口上产生连接请求，从外部打开防火墙上的端口的方法。一旦收到正确地连接请求序列，防火墙规则就会被动态修改，以允许发送连接请求的主机通过特定端口进行连接。
* 现有的一些安全技术也可以达到类似的攻击面隐藏效果，如Port-knocking、SPA及SDP解决方案


# 端口碰撞使用
配置端口碰撞服务 knockd，其中使用了 [[Linux 防火墙|Linux 的 iptables]]
`cat /etc/knockd.conf`
`[options]`
`UseSyslog`
`[openSSH]`
`command     = /sbin/iptables -A INPUT -s %IP% -p tcp --dport 22 -j ACCEPT`
`tcpflags    = syn`
`[closeSSH]`
`command     = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT`
`tcpflags    = syn`
**进行端口碰撞**
使用telnet开启端口
`telnet 192.168.1.100 7000`
`telnet 192.168.1.100 8000`
`telnet 192.168.1.100 9000`
反之可以关闭端口
`telnet 192.168.1.100 9000`
`telnet 192.168.1.100 8000`
`telnet 192.168.1.100 7000`
使用knock程序
`knock 192.168.1.100 7000 8000 9000`  开启端口
`knock 192.168.1.100 9000 8000 7000`  关闭端口
使用[[端口扫描#netcat(nc)端口扫描|nc]]
`nc -z 192.168.1.100 7000 8000 9000`  开启端口
使用[[端口扫描#nmap端口扫描|nmap]]
`for i in 7000 8000 9000;do nmap -Pn --host timeout 201 --max-retries 0 -p $i 192.168.1.100;done`



