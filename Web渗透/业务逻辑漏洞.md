# 商品数据逻辑漏洞
**漏洞挖掘**
首先发送正常的数据包，了解整个数据交换流程，以及页面跳转
**漏洞利用**
* 订单ID篡改
查看自己订单，修改 订单ID查看是否能查看其他订单信息
* 商品编号篡改
积分商城，利用低积分兑换高积分礼物
选取低积分礼物兑换，提交抓包
修改其中的 goods_id（商品编号）为高积分的商品编号
提交，就可以发现逻辑漏洞的实现
* 用户ID篡改
抓包查看自己的 用户ID，修改 ID查看是否能查看其他用户信息
* 金额 篡改
抓包修改金额等字段
将支付页面抓取请求中商品的金额字段，修改成任意数额的金额（如负数）
提交，查看能否以修改后的金额数据完成业务流程
* 商品数量 篡改
抓包修改商品数量等字段
很多商品限制用户购买数量，服务器仅在页面通过 `JS` 脚本限制，未在服务端校验用户提交的数量，通过抓包修改商品最大限制数量，即将请求中的商品数量改为大于最大数值限制，查看是否能完成修改后的数量完成业务流程



# 认证模块逻辑漏洞

**漏洞利用**
  * 暴力破解
在 没有 验证码限制或者一次验证码可以使用 多次 使用的情况下
使用已知用户名对密码进行暴力破解
使用一个弱口令密码对用户进行暴力破解
  * Cookie 仿冒欺骗
通过修改 Cookie中的某个参数来实现登录其他用户
或者直接进去后台，代码验证设计缺陷导致，一些网站会利用 Cookie 是否为空、Session是否为 true 来判断用户是否可以登录，只要构造一个 Cookie或 Session为 true就可以绕过认证登录
*一般从代码审计得出的漏洞，黑盒很难找出这样的漏洞*
  * 前端js代码验证
js禁用可以绕过，对于按钮使用审查url，通过url进行访问
也可以使用burpsuit拦截页面绕过
  * 服务器响应欺骗
通过抓取某请求包拦截对应响应包来修改服务器的响应
修改位置：
响应码
修改返回数据包内容：
例如增删js代码
把包中false改成true
0改成1
把no改成yes
可以通过前台账号登录成功的响应页面来参考修改后台。
  * 密码重置逻辑
尝试正常密码找回流程
选择不同的找回方式，记录所有数据包
分析数据包，找出敏感部分
分析后台找回机制所采用的验证手段
修改数据包进行验证是否存在密码找回漏洞(爆破验证码（有时验证码是前端生成）)
  * 用户凭证暴力破解
四位或六位纯数字，验证码次数未限制
根据手机号找回密码，随便输个验证码，抓包,暴力破解验证码（假如只有四位），很快就可以破解出来
*注意：如果验证码次数限制，破解一会就会提示请求过于频繁，这时就需要绕过限制*
限制绕过：国内很多情况下都没有过滤字符和限制输出长度，验证很有可能只是简单的处理
  * 修改请求参数
指定别人用户密码找回在接收验证码的时候抓包，把发送验证码的邮箱或者手机号改成自己的。
指定自己密码找回最后提交的时候抓包吧用户名或者用户id改成别人的。
修改提交的响应包来欺骗服务器验证。
注册重复的用户名，例如 admin，相当于修改了密码
  * 重新绑定
给已知账户绑定手机，发现绑定手机的 URL 链接中有 uid 参数，修改 uid 参数为他人的，即可实现将他人的账户绑定上自己的手机，之后通过手机来修改密码
修改个人资料处抓包，修改 userId 为他人，修改mobilePhone 为自己的手机，即可实现将他人的账户绑定上自己的手机，之后通过手机来修改密码
  * 跳过找回步骤
跳过验证步骤、找回方式、直接到设置新密码页面
  * 绕过授权验证
水平越权:水平越权是指同等权限级别越权
纵向越权:纵向越权是指不同等权限级别越权
漏洞出现点：
数据交互的地方
用户可操作的地方
参数可控制的地方



# 业务流程模块逻辑漏洞
**漏洞利用**
  * 业务重放测试
在生成的订单流程时抓取订购请求
观察每次订购相同商品的请求是否存在不同的随机token、可变参数等，若有则检查这些随机的变化情况和失效情况，是否在当前订购流程中唯一有效
尝试重放之前已经完成流程的订购请求，观察服务器是否做出正确响应，若订购再次生效，则存在该漏洞。
  * 业务上限测试
该测试主要判断应用程序是否对业务预期范围外的业务请求做出正确响应。
  * 业务流程乱序测试
乱序测试主要是对业务流程是否正常，确保攻击者无法通过技术手断绕过某些重要流程步骤，检验办理业务过程中是否有可控制来保证其遵循正常流程。


